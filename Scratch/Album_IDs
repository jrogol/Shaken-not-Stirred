from pandas.io import sql
import psycopg2 as psql

# List of album IDs (obtained through Spotify software, copied the link)
Dr_No = ''
FRWL = ''
Goldfinger = '2j2bpDzIPwQcbL9dapv2gV'
Thunderball = '3VEq0jeSYz3Yzh2ibaqryN'
YOLT = '70yvWorA4DzKWsS3Nvz89q'
OHMSS = '4BVd2gkQNWj30YN5P3r8Av'
Diamonds = '5Ekn0VinHi7JQTZECFC10k'
LLD = ''
MwGG = '73keMsTiKlV4N852puufnJ'
TSWLM = '5k55f89cnXdy0BikkUeBHJ'
Moonraker = '5mkRj3kQB6NW3wNLoqvnu7'
FYEO = ''
Octopussy = ''
VtaK = ''
Daylights = ''
LtK = ''
Goldeneye = '4aBVXvgB75LzBQTbKiauQN'
TND = '2UGZoHiNl2bDZyHIbaQ9Vo'
Enough = '39yJXK8vsNtRui2NQFBShp'
DAD = '1oP3qigyxt9YKSUtDx6qOm'
Casino = '4GWyNknKDbVB8Lg1IiTy5k'
Quantum = '2ahUhfrELmIHEUEiWUC1Nv'
Skyfall = '0jovLA7GjtZrj7FHpL7N2g'
spectre = '1csBgT42N4pPPs1HJhxXIK'

bestOfBond = '2lHvf04m2IO93HC7PNdkfL'

all_films = [Dr_No,FRWL,Goldfinger,Thunderball,YOLT,OHMSS,Diamonds,LLD,MwGG,TSWLM,Moonraker,FYEO,Octopussy,VtaK,Daylights, LtK,Goldeneye,TND,Enough,DAD,Casino,Quantum,Skyfall,spectre]


# Conect to PSQL
conn = psql.connect(
    "dbname='bond' user=jamesrogol host=localhost")
# Query the PostgreSQL database for films, append all_films as the album_id
df = sql.read_sql('SELECT film FROM films;',conn).assign(album_id=all_films)
# Sanity Check!
df

# Loop over the rows of the above data frame, and update the appropriate
# information in the database
for i in range(0,len(df)):
    try:
        cur = conn.cursor()
        command = "UPDATE films SET album_id = '%s' WHERE film = '%s';"%(df.iloc[i]['album_id'],df.iloc[i]['film'])
        cur.execute(command)
        conn.commit()
        cur.close()
    except:
        conn.rollback()
# Sanity Check!
sql.read_sql('SELECT * FROM films',conn)
